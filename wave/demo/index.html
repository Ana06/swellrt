<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="utf-8">
  <meta http-equiv="X-UA-Compatible" content="IE=edge">
  <meta name="viewport" content="width=device-width, initial-scale=1">

  <title>SwellRT Server is running!</title>
  <link rel="stylesheet" href="css/bootstrap.min.css">

  <style type="text/css">

    .logo {
      margin-top: 1em;
      margin-bottom: 1em;
    }

    .m-top-1 {
      margin-top: 1em;
    }

  </style>

</head>
<body>

  <div class="container-fluid">

    <div class="row">
      <div class="col-md-12 center m-top-1">
          <img class="logo center-block" src="img/swellrt-logo-h-medium.png" width="260px" />
          <h2 class="text-center m-top-1">Server status is <span id="status"></span></h2>
      </div>
    </div>

    <div class="row">
      <div class="col-xs-offset-2 col-xs-8 m-top-1">

          <h3 class="text-center">Now, you might be interested on...</h3>
      </div>
    </div>

    <div class="row hidden" id="topics-ok">
      <div class="col-xs-offset-3 col-xs-6">
          <ul>
            <li>
              <a><h4>Server configuration</h4></a>
              Database connection, email settings, network interfaces, disable welcome page...
            </li>

            <li>
              <a><h4>Demo apps</h4></a>
              Checkout simple HTML apps showing SwellRT basics
            </li>

            <li>
              <a><h4>Set up federation</h4></a>
              Connect this server with a remote SwellRT instance
            </li>

            <li>
              <a><h4>Get support</h4></a>
              Visit our <a href="https://gitter.im/P2Pvalue/swellrt">Gitter channel</a> or check out <a href="https://github.com/P2Pvalue/swellrt/wiki">documentation</a>
            </li>

          </ul>
      </div>
    </div>


    <div class="row hidden" id="topics-error">
      <div class="col-xs-offset-3 col-xs-6">
          <ul>
            <li>
              <a><h4>Check Server configuration</h4></a>

              <p>
              Database connection, email settings, network interfaces...
              </p>

              <p>

              </p>

            </li>

            <li>
              <a><h4>Get support</h4></a>

              Visit our <a href="https://gitter.im/P2Pvalue/swellrt">Gitter channel</a> or check out <a href="https://github.com/P2Pvalue/swellrt/wiki">documentation</a>
            </li>

          </ul>
      </div>
    </div>

  </div>


  <script src="js/jquery.min.js"></script>
  <script src="js/bootstrap.min.js"></script>
  <script src="/swellrt-beta.js"></script>
  <script>

    swellrt.onReady(function(s) {

      var api = s;

      api.login({
        id : "_anonymous_",
        password : ""
      })
      .then(r=>{
        return api.open({
          id : "local.net/status-echo"
        });
      })
      .then(r=>{

        // throw "TESTING ERROR";

        var controller = r.controller;
        var object = controller.asNative();

        if (!object.signal) {
            object.signal = new Date();
            controller.makePublic(true);
        }
        console.log("checking swellrt status signal -> "+object.signal);
        object.signal = new Date();

        document.getElementById('status').innerHTML = '<span class="label label-success">OK</span>';
        document.getElementById('topics-ok').classList.remove('hidden');

        __status__ = true;
      })
      .catch(e=>{
        console.log(e);
        document.getElementById('status').innerHTML = '<span class="label label-danger">ERROR</span>';
        document.getElementById('topics-error').classList.remove('hidden');

        __status__ = false;
      });

    });

  </script>



  </body>

  </html>
